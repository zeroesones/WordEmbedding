import pandas as pd
import re
from datetime import datetime
import datefinder

# Sample data
data = {'ContractDate': ['Agreement dated as o May 19, 2008',
                         'Master Agreement dated as of 9th July 2004',
                         'Agreement A dated as o 10th July 2008 B dated as of 10 October 2022 C dated as o October 312008',
                         'Amendment dated as of January 24, 20! 8']}
df = pd.DataFrame(data)

# Function to extract and clean dates
def extract_clean_date(text):
    # Remove noise characters
    cleaned_text = re.sub(r'20! 8', '2018', text)
    cleaned_text = re.sub(r'[^0-9a-zA-Z\s]', '', cleaned_text)
    
    # Replace '20! 8' with '2018'
    
    print(cleaned_text)

    # Use datefinder to extract dates
    matches = list(datefinder.find_dates(cleaned_text, strict=True))
    print(matches)
    if matches:
        # Get the first matched date and format it
        extracted_date = matches[0]
        return extracted_date.strftime('%Y-%m-%d')
    
    return None

# Apply the function to the 'ContractDate' column
df['CleanedDate'] = df['ContractDate'].apply(extract_clean_date)

# Display the cleaned dates
print(df)
