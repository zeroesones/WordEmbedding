import pandas as pd
from dateutil.parser import parse
import re

# Sample DataFrame
data = {
    'sentences': [
        'The event was on September 28,2009, and the follow-up was on October 2, 2009.',
        'Our meeting is scheduled for 07 January 2005.',
        'The deadline is January 7,2005.',
        'Appointment on 1 March 2017.'
    ]
}

df = pd.DataFrame(data)

# Function to extract all dates and return the latest one
def extract_latest_date(sentence):
    dates = []
    remaining_sentence = sentence
    while True:
        try:
            # Extract the first date
            date = parse(remaining_sentence, fuzzy=True, default=None)
            if date:
                dates.append(date)
                # Remove the part of the sentence up to and including the found date
                remaining_sentence = re.sub(r'^.*?\b{}\b'.format(re.escape(str(date.date()))), '', remaining_sentence, 1)
            else:
                break
        except (ValueError, TypeError):
            break
    if dates:
        return max(dates)
    else:
        return None

# Apply the function to the DataFrame
df['extracted_dates'] = df['sentences'].apply(extract_latest_date)

print(df)
