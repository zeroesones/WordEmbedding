import pandas as pd
import re
from dateutil.parser import parse

# Sample DataFrame
data = {
    'sentences': [
        'The event was on September 28,2009.',
        'Our meeting is scheduled for 07 January 2005.',
        'The deadline is January 7,2005.',
        'Appointment on 1 March 2017.',
        'This sentence does not contain a date.'
    ]
}

df = pd.DataFrame(data)

# Function to format and extract dates
def extract_dates(sentence):
    # Stricter regex pattern to match dates
    matches = re.findall(r'(\bJanuary|February|March|April|May|June|July|August|September|October|November|December\b\s+\d{1,2}\s*,?\s*\d{4}|\d{1,2}\s+\bJanuary|February|March|April|May|June|July|August|September|October|November|December\b\s*,?\s*\d{4})', sentence)
    for match in matches:
        try:
            # Check if the match reasonably looks like a date
            if re.search(r'\d', match):
                return parse(match, fuzzy=False)
        except ValueError:
            continue
    return None

# Apply the function to the DataFrame
df['extracted_dates'] = df['sentences'].apply(extract_dates)

print(df)
