import fitz  # PyMuPDF
import pandas as pd

def extract_text_from_word_doc(docx_file_path):
    pdf_document = fitz.open(docx_file_path)
    text_pages = {}

    for page_number in range(pdf_document.page_count):
        page = pdf_document.load_page(page_number)
        page_text = page.get_text()
        text_pages[f"Page{page_number + 1}"] = page_text.replace('\n', '')  # Remove page breaks

    return text_pages

def main():
    docx_file_path = "your_word_document.docx"  # Replace with the path to your Word document
    extracted_text = extract_text_from_word_doc(docx_file_path)
    
    # Convert the extracted text into a Pandas DataFrame
    df = pd.DataFrame.from_dict(extracted_text, orient='index', columns=['Text'])
    
    # Save the DataFrame to a JSON file
    output_file_path = "output.json"
    df.to_json(output_file_path, orient='index')
    
    print(f"JSON data saved to {output_file_path}")

if __name__ == "__main__":
    main()
